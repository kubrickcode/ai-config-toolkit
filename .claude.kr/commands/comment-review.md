---
description: 주석 리뷰 및 정리 제안 (불필요한 주석 식별, 개선 권장)
---

# 주석 리뷰 커맨드

## 목적

주석 품질을 검토하고 정리 방향을 제안한다.

**핵심 원칙**: 코드가 스스로 설명해야 한다. 주석은 최후의 수단.

---

## 사용자 입력

```text
$ARGUMENTS
```

**해석 우선순위**:
1. $ARGUMENTS가 있으면 → 사용자 요청 따르기 (파일 경로, `--all` 전체 프로젝트 등)
2. 비어있으면 → `git status`로 커밋되지 않은 변경사항 확인
3. 변경사항 없으면 → 최신 커밋 검토
4. 전체 프로젝트는 명시적 요청 시에만 (`--all` 또는 "전체 코드베이스 검토")

---

## 주석 원칙

### 🚫 주석을 피해야 하는 이유

- 주석은 코드와 동기화되지 않아 거짓말이 된다
- 나쁜 이름을 보상하려는 신호일 수 있다
- 대부분의 경우 코드 개선으로 해결 가능

### ✅ 합법적인 주석 사례

| 카테고리 | 설명 | 예시 |
|----------|------|------|
| **공개 API 문서화** | JSDoc, TSDoc, GoDoc 등 | `@param`, `@returns`, `@throws` |
| **비즈니스 로직 WHY** | 코드만으론 설명 불가한 도메인 지식 | "규제 요구사항으로 인해...", "고객 요청에 따라..." |
| **외부 의존성** | API 한계, 정책, quirks | "Stripe API는 최대 100개만 반환", "CORS 제한으로 인해..." |
| **성능/보안 경고** | 의도적인 기술 결정 | "O(n²)이지만 n < 10 보장됨", "SQL injection 방지용" |
| **복잡한 패턴** | 정규식, 알고리즘 의도 | 정규식 각 부분 설명, 알고리즘 선택 이유 |
| **법적/라이선스** | 저작권, 특허 | "MIT License", "Based on Apache algorithm" |
| **TODO/FIXME** | 컨텍스트 포함 필수 | `// TODO(username): #123 마이그레이션 후 제거` |

### ⚠️ 비즈니스 로직 주석 규칙

**응집 원칙**: 동일 비즈니스 로직 설명은 **한 곳에만** 존재해야 한다.
- ❌ 분산된 주석: 여러 파일에 같은 규칙 반복
- ✅ 응집된 주석: 핵심 도메인 모듈에 한 번만

---

## 분류 기준

### ❌ REMOVE (제거 권장)

| 유형 | 예시 | 이유 |
|------|------|------|
| 자명한 설명 | `// increment counter` 위의 `counter++` | 코드가 이미 설명함 |
| 이름 보상 | `// get user data` 위의 `getData()` | 함수명을 `getUserData()`로 변경 |
| 주석 처리된 코드 | `// oldFunction()` | Git 히스토리 사용 |
| 섹션 구분 | `// ===== Validation =====` | 함수 추출로 해결 |
| 타입 중복 | `// returns string` (TypeScript) | 타입 시스템이 설명함 |
| 오래된/거짓 주석 | 코드와 불일치 | 유지보수 위험 |
| 닫는 괄호 주석 | `} // end if` | 들여쓰기로 충분 |

### ⚠️ IMPROVE (개선 필요)

| 유형 | 문제 | 개선 방향 |
|------|------|----------|
| 불명확한 TODO | `// TODO: fix later` | `// TODO(user): #ticket 구체적 내용` |
| WHAT 설명 | "사용자 검증을 한다" | WHY를 설명: "보안 규정 때문에..." |
| 장황한 주석 | 단락 수준의 설명 | 핵심만 간결하게 |
| 문서화 표준 미준수 | 일반 주석으로 API 설명 | JSDoc/TSDoc/GoDoc 형식 사용 |
| 분산된 비즈니스 주석 | 같은 규칙이 여러 곳에 | 한 곳에 응집 |

### ✅ KEEP (유지)

합법적인 주석 사례에 해당하면서:
- 간결하고 명확함
- 코드와 동기화됨
- WHY를 설명함
- 적절한 위치에 응집됨

---

## 워크플로우

### 1. 분석 대상 결정

```bash
git status --porcelain
```

**결정 트리**:
1. $ARGUMENTS에 특정 요청 있음 → 요청 따르기
2. $ARGUMENTS 비어있음 + 커밋되지 않은 변경 있음 → `git diff`로 변경 파일 분석
3. $ARGUMENTS 비어있음 + 변경 없음 → `git show HEAD`로 최신 커밋 분석
4. 사용자가 전체 프로젝트 명시적 요청 (`--all`) → 전체 프로젝트 스캔

### 2. 주석 추출

**언어별 주석 패턴**:
- TypeScript/JavaScript: `//`, `/* */`, `/** */`
- Go: `//`, `/* */`
- Python: `#`, `""" """`
- HTML/JSX: `{/* */}`, `<!-- -->`

**각 주석에 포함**:
- 주석 내용
- 파일 경로:라인번호
- 주변 코드 컨텍스트 (±3줄)

### 3. 분류 및 분석

각 주석에 대해:
1. 분류 (REMOVE / IMPROVE / KEEP)
2. 판단 근거
3. 리팩토링 제안 (해당 시)

### 4. 조치 결정

| 상황 | 조치 |
|------|------|
| **명백한 제거 대상** (주석 처리된 코드, 자명한 설명) | 질문 없이 즉시 수정 |
| **논의 필요** (의도 불명확, 판단 필요) | 대화에서 제안 |
| **전체 프로젝트 리뷰** | 리팩토링 제안 섹션 포함한 공식 리포트 생성 |

---

## 출력 형식

### 개별 파일 / 변경사항 (대화형)

대화에서 직접 피드백 제공:
- 발견된 이슈 파일:라인 참조와 함께 나열
- 간단히 근거 설명
- 명백한 수정은 즉시 적용
- 논의가 필요한 개선사항 제안

### 전체 프로젝트 리뷰 (공식 리포트)

전체 프로젝트 리뷰 시에만 생성 (`--all`):

```markdown
# 📝 주석 리뷰 리포트

**생성일**: {timestamp}
**범위**: 전체 프로젝트
**분석된 주석 수**: {count}

---

## 📊 요약

| 카테고리 | 수량 | 비율 |
|----------|------|------|
| ❌ REMOVE | {n} | {%} |
| ⚠️ IMPROVE | {n} | {%} |
| ✅ KEEP | {n} | {%} |

---

## ❌ REMOVE - 제거 권장 ({count})

### 1. {file_path}:{line}
... 상세 내용 ...

---

## ⚠️ IMPROVE - 개선 필요 ({count})

### 1. {file_path}:{line}
... 상세 내용 ...

---

## ✅ KEEP - 유지 ({count})

합법적인 주석 간략 목록.

---

## 🔧 리팩토링 제안

### 함수 추출 (Extract Function)
... 제안 ...

### 이름 변경 (Rename)
... 제안 ...

---

## 📋 조치 체크리스트

- [ ] 불필요한 주석 {n}개 제거
- [ ] 주석 {n}개 개선
- [ ] 리팩토링 {n}개 적용
```

---

## 실행 지침

1. **입력 파싱**: $ARGUMENTS 해석
2. **범위 결정**:
   - 사용자 요청 → 따르기
   - 비어있음 → `git status --porcelain` 확인
   - 변경 있음 → 변경 파일에 `git diff` 사용
   - 변경 없음 → 최신 커밋에 `git show HEAD` 사용
3. **주석 추출**: 대상 파일에서 주석 패턴 검색
4. **분류**: 분류 기준 적용
5. **조치**:
   - 명백한 이슈 → 즉시 수정
   - 불명확한 경우 → 대화에서 제안
   - 전체 프로젝트 → 공식 리포트 생성
6. **언어 표준**: JSDoc, TSDoc, GoDoc 규칙 고려
7. **공개 API**: 문서화 주석 유지 권장

---

## 사용 예시

```bash
# 특정 파일 리뷰
/comment-review src/utils/parser.ts

# 현재 변경사항 리뷰 (기본 동작)
/comment-review

# 최신 커밋 명시적 리뷰
/comment-review --last-commit

# 전체 프로젝트 리뷰 (공식 리포트 생성)
/comment-review --all
```
